<!-- <div style="width: 100%; margin-top: -10px !important;"> -->
<div style="padding: 30px;">

    <div class="divTitle-center" style="margin-top: 0px;"
    *ngIf="salesHeaderForm.idSale > 0">
        Venta #{{ salesHeaderForm.idSale }} {{ ( salesHeaderForm.pendingAmount == 0 ? ' - PAGADO' : '- PENDIENTE: ' + ( salesHeaderForm.pendingAmount | currency ) ) }}
    </div>

    <div class="row">
        <div class="col-md-12">

            <div class="row">
                            
                <div class="col-md-12">
                    <mat-label>Vendedor: </mat-label>
                    <mat-form-field
                    style="width: 100%;">
                        <input #cbxSellerCBX
                        type="text"
                                id="cbxSeller"
                                style="width: 100%;"
                                placeholder="Selecciona..."
                                aria-label="Number"
                                matInput
                                [(ngModel)]="salesHeaderForm.sellerDesc"
                                [matAutocomplete]="cbxSeller"
                                
                                (keyup)="CBXskeyup( 2, cbxSellerCBX.value )"

                                (click)="cbxSellers_Clear()">
                                <button *ngIf="salesHeaderForm.sellerDesc" matSuffix mat-icon-button aria-label="Clear" (click)="cbxSellers_Clear()">
                                    <mat-icon>close</mat-icon>
                                </button>
                        <mat-autocomplete autoActiveFirstOption
                                            #cbxSeller="matAutocomplete"
                                            (optionSelected)="cbxSellers_SelectedOption( $event )">
                            <mat-option *ngFor="let item of cbxSellers" [value]="item">
                                {{ item.name }}
                            </mat-option>
            
                            <mat-option value="" *ngIf="salesHeaderForm.sellerDesc.length > 0 && salesHeaderForm.sellerResp.length > 0">
                                {{ salesHeaderForm.sellerResp }}
                            </mat-option>
            
                        </mat-autocomplete>
                    </mat-form-field>
                </div>

            </div>

            <div class="row">
                            
                <div class="col-md-10">
                    <mat-label>Cliente: </mat-label>
                    <span class="material-icons manitaSobre colorGreen"
                        (click)="showCustomerCat( 0 )">
                        add_circle_outline
                        </span>
                    <mat-form-field
                    style="width: 100%;">
                        <input #cbxCustomerCBX
                        type="text"
                                id="cbxCustomer"
                                style="width: 100%;"
                                placeholder="Selecciona..."
                                aria-label="Number"
                                matInput
                                [(ngModel)]="salesHeaderForm.customerDesc"
                                [matAutocomplete]="cbxCustomer"
                                
                                (keyup)="CBXskeyup( 1, cbxCustomerCBX.value )"

                                (click)="cbxCustomers_Clear()">
                                <button *ngIf="salesHeaderForm.customerDesc" matSuffix mat-icon-button aria-label="Clear" (click)="cbxCustomers_Clear()">
                                    <mat-icon>close</mat-icon>
                                </button>
                        <mat-autocomplete autoActiveFirstOption
                                            #cbxCustomer="matAutocomplete"
                                            (optionSelected)="cbxCustomers_SelectedOption( $event, cbxSaleTypeCBX )">
                            <mat-option *ngFor="let item of cbxCustomers" [value]="item">
                                {{ item.name }}
                            </mat-option>
            
                            <mat-option value="" *ngIf="salesHeaderForm.customerResp.length > 0 && salesHeaderForm.customerResp.length > 0">
                                {{ salesHeaderForm.customerResp }}
                            </mat-option>
            
                        </mat-autocomplete>
                    </mat-form-field>
                </div>

                <div class="col-md-2">
                    <mat-label>Condición de pago: </mat-label>
                    <mat-form-field
                    style="width: 100%;"
                    (click)="cbxSalesType_Search()">
                        <input #cbxSaleTypeCBX
                                type="text"
                                style="width: 100%;"
                                placeholder="Selecciona..."
                                aria-label="Number"
                                matInput
                                [(ngModel)]="salesHeaderForm.saleTypeDesc"
                                [matAutocomplete]="cbxSaleType"
                                
                                (input)="cbxSalesType_Search()"
                                (click)="cbxSalesType_Clear()"
                                (focus)="cbxSalesType_Search()">
                                <button *ngIf="salesHeaderForm.saleTypeDesc" matSuffix mat-icon-button aria-label="Clear" (click)="cbxSalesType_Clear()">
                                    <mat-icon>close</mat-icon>
                                </button>
                        <mat-autocomplete autoActiveFirstOption
                                            #cbxSaleType="matAutocomplete"
                                            (optionSelected)="cbxSalesType_SelectedOption( $event )">
                            <mat-option *ngFor="let item of cbxSalesType" [value]="item">
                                {{ item.name }}
                            </mat-option>
            
                            <mat-option value="" *ngIf="cbxSalesType.length == 0 && salesHeaderForm.saleTypeDesc">
                                No se encontró nada...
                            </mat-option>
            
                        </mat-autocomplete>
                    </mat-form-field>
                </div>

            </div>

            <div class="row">
                <div class="col-md-12">

                        <div class="row" *ngIf="salesHeaderForm.idSale == 0">
                            
                            <div class="col-md-4">
                                <mat-form-field fxLayout.xs="column" class="with100">
                                    <mat-label>Código de barras</mat-label>
                                    <mat-icon matPrefix class="my-icon">qr_code</mat-icon>
                                    <input #barCode
                                    matInput
                                    placeholder="Ingrese un Código de barras"
                                    [(ngModel)]="salesDetailForm.barCode"
                                    (keyup.enter)="ev_fn_barCode_keyup_enter($event)"
                                    (click)="cbxProducts_Clear()">
                                </mat-form-field>
                            </div>

                            <div class="col-md-8">
                                <mat-form-field
                                style="width: 100%;"
                                (click)="cbxProducts_Search()">
                                    <input #cbxProductss
                                            type="text"
                                            id="cbxProduct"
                                            style="width: 100%;"
                                            placeholder="Selecciona un producto..."
                                            aria-label="Number"
                                            matInput
                                            [(ngModel)]="salesDetailForm.productDesc"
                                            [matAutocomplete]="cbxProduct"
                                            
                                            (input)="cbxProducts_Search()"
                                            (click)="cbxProducts_Clear()">
                                            <button *ngIf="salesDetailForm.productDesc" matSuffix mat-icon-button aria-label="Clear" (click)="cbxProducts_Clear()">
                                                <mat-icon>close</mat-icon>
                                            </button>
                                    <mat-autocomplete autoActiveFirstOption
                                                        #cbxProduct="matAutocomplete"
                                                        (optionSelected)="cbxProducts_SelectedOption( $event )">
                                        <mat-option *ngFor="let item of cbxProducts" [value]="item">
                                            <mat-icon matPrefix class="my-icon">qr_code</mat-icon>{{ item.nameConcat }}
                                        </mat-option>
                        
                                        <mat-option value="" *ngIf="cbxProducts.length == 0 && salesDetailForm.productDesc">
                                            No se encontró nada...
                                        </mat-option>
                        
                                    </mat-autocomplete>
                                </mat-form-field>
                            </div>

                        </div>

                        <div class="row" *ngIf="salesHeaderForm.idSale == 0">
                            
                            <div class="col-md-4">
                                <mat-form-field class="with100">
                                    <mat-label>Cantidad</mat-label>
                                    <input #tbxCantidad
                                    matInput
                                    placeholder="Ingrese la cantidad"
                                    type="number"
                                    class="textAlingRight"
                                    [(ngModel)]="salesDetailForm.cantidad"
                                    (keyup.enter)="ev_fn_cbxCantidad_keyup_enter($event)">
                                </mat-form-field>
                            </div>

                            <div class="col-md-4">
                                <mat-form-field class="with100">
                                    <mat-label>Precio unitario</mat-label>
                                    <input matInput currencyMask placeholder="Ingrese el precio unitario"
                                    #precioUnitario
                                    class="textAlingRight"
                                    [(ngModel)]="salesDetailForm.precioUnitario"
                                    
                                    readonly="true">
                                </mat-form-field>
                            </div>

                            <div class="col-md-4">
                                <mat-form-field class="with100">
                                    <mat-label>Descuento</mat-label>
                                    <input #cbxDescuento
                                    matInput
                                    placeholder="Ingrese un descuento"
                                    type="number"
                                    class="textAlingRight"
                                    [(ngModel)]="salesDetailForm.descuento"
                                    (keyup.enter)="addSaleDetail()">
                                </mat-form-field>
                            </div>
                            
                        </div>

                        <div class="row top10px">
                            <div class="col-md-12">
                                <div style="float: left;">
                                    
                                    <button mat-raised-button
                                    color="primary"
                                    type="submit"
                                    class="marginRight10px"
                                    (click)="addSaleDetail()"
                                    [disabled]="!ev_fnShowBtnAddSaleDetail()"
                                    *ngIf="salesHeaderForm.idSale == 0">
                                    <mat-icon matPrefix class="my-icon">add</mat-icon>
                                    Agregar</button>
                                    
                                    <button mat-raised-button
                                    type="button"
                                    class="marginRight10px"
                                    (click)="fnClearSalesDetailForm()"
                                    *ngIf="salesHeaderForm.idSale == 0">
                                    <mat-icon matPrefix class="my-icon">clear</mat-icon>
                                    limpiar</button>

                                    <button mat-raised-button
                                    color="primary"
                                    type="submit"
                                    class="marginRight10px"
                                    (click)="fn_ShowPaymentCreateSale( false )"
                                    [disabled]="!ev_fnShowBtnGuardarSinAnticipo()"
                                    *ngIf="( salesHeaderForm.idSaleType == 1
                                    || this.salesHeaderForm.idSaleType == 3
                                    || this.salesHeaderForm.idSaleType == 4 ) && salesHeaderForm.idSale == 0">
                                    <mat-icon matPrefix class="my-icon">save</mat-icon>
                                    Guardar sin anticipo</button>

                                    <button mat-raised-button
                                    color="primary"
                                    type="submit"
                                    class="marginRight10px"
                                    (click)="fn_ShowPaymentCreateSale( true )"
                                    [disabled]="!ev_fnShowBtnPagar()"
                                    *ngIf="salesHeaderForm.pendingAmount > 0 && dataStone.idSaleType != 4 && salesHeaderForm.idSaleType != 4">
                                    Pagar {{ ( salesHeaderForm.pendingAmount | currency ) }}</button>

                                    <button mat-raised-button
                                    color="primary"
                                    type="submit"
                                    class="marginRight10px"
                                    (click)="fn_NuevaVenta()">
                                    <mat-icon matPrefix class="my-icon">add_circle_outline</mat-icon>
                                    Nueva venta</button>

                                    <button mat-raised-button
                                    type="button"
                                    class="marginRight10px"
                                    (click)="fn_CerrarMDL()">
                                    <mat-icon matPrefix class="my-icon">close</mat-icon>
                                    Cerrar</button>

                                    <button mat-raised-button
                                    color="primary"
                                    type="submit"
                                    class="marginRight10px"
                                    (click)="fn_CrearVentaApartirDeConsignacion( true )"
                                    *ngIf="dataStone.idSaleType == 4">
                                    <mat-icon matPrefix class="my-icon">add_circle_outline</mat-icon>
                                    Crear venta a crédito</button>

                                    <button mat-raised-button
                                    color="primary"
                                    type="submit"
                                    class="marginRight10px"
                                    (click)="fn_CrearVentaApartirDeConsignacion( false )"
                                    *ngIf="dataStone.idSaleType == 4">
                                    <mat-icon matPrefix class="my-icon">add_circle_outline</mat-icon>
                                    Crear venta de contado</button>

                                    <button mat-raised-button
                                    color="primary"
                                    type="submit"
                                    class="marginRight10px"
                                    (click)="fn_RegresarProductoDeConsignacion()"
                                    *ngIf="dataStone.idSaleType == 4">
                                    <mat-icon matPrefix class="my-icon">arrow_back</mat-icon>
                                    Regresar producto</button>

                                    <button mat-raised-button
                                    color="primary"
                                    type="submit"
                                    class="marginRight10px"
                                    (click)="ev_PrintTicket()">
                                    <mat-icon matPrefix class="my-icon">print</mat-icon>
                                    Imprimir</button>

                                    
                                </div>
                            </div>
                        </div>

                        <div class="divSection">

                            <div class="row top20px">

                                <div class="col-md-12">
                                    <div class="table-responsive">
                                        <table class="table table-hover">
                                            <thead>
                                                <th class="textAlingCenter padding-th">Acciones</th>
                                                <th class="textAlingCenter padding-th">Código</th>
                                                <th class="textAlingCenter padding-th">Descripción</th>
                                                <th class="textAlingCenter padding-th">Cantidad</th>
                                                <th class="textAlingCenter padding-th"
                                                *ngIf="interface.showDescuento">Precio Unitario</th>
                                                <th class="textAlingCenter padding-th"
                                                *ngIf="interface.showDescuento">Descuento</th>
                                                <th class="textAlingCenter padding-th">Precio</th>
                                                <th class="textAlingCenter padding-th">Importe</th>
                                            </thead>
        
                                            <tbody>
                                                <tr *ngFor="let item of salesHeaderForm.saleDetail; let i = index">
    
    
                                                    <td class="textAlingCenter">
                                                        <div style="width: 80px;">
                                                            <mat-checkbox *ngIf="dataStone.idSaleType == 4" class="manitaSobre" [(ngModel)]="item.select"></mat-checkbox>
                                                            <span *ngIf="idSale == 0" class="material-icons manitaSobre colorRed"
                                                                (click)="event_fnClick_DeleteProductFromList( i )">
                                                                delete_outline
                                                            </span>
                                                        </div>
                                                    </td>
                                                    <td class="textAlingLeft">
                                                        <div class="row">
                                                            <div class="col-md-1">
                                                                <mat-icon style="margin-top: -5px;" matPrefix class="my-icon">qr_code</mat-icon>
                                                            </div>
                                                            <div class="col-md-10">
                                                                <label style="margin-left: 10px;">{{ item.barCode }}</label>
                                                            </div>
                                                        </div>
                                                        
                                                    </td>
                                                    <td style="text-align:left;">{{ item.productDesc }}</td>
                                                    <td style="text-align: right;">{{ item.cantidad }}</td>
                                                    <td style="text-align: right;"
                                                    *ngIf="interface.showDescuento">{{ item.precioUnitario | currency }}</td>
                                                    <td style="text-align: right;"
                                                    *ngIf="interface.showDescuento">{{ item.descuento | currency }}</td>
                                                    <td style="text-align: right;">{{ item.precio | currency }}</td>
                                                    <td style="text-align: right;">{{ item.importe | currency }}</td>
                                                </tr>
                                                
                                            </tbody>
                                            
                                        </table>
                                    </div>
                                    
                                </div>
    
                            </div>
    
                            <div class="row">
                                
                                <div class="col-md-8">
                                    
                                </div>
    
                                <div class="col-md-4">
                                    <div class="row">
                                        <div class="col-md-12">
                                            <mat-form-field class="with100 top20px">
                                                <mat-label>TOTAL</mat-label>
                                                <input #total
                                                class="textAlingRight colorGreen fontSize"
                                                matInput
                                                currencyMask
                                                placeholder="TOTAL"
                                                
                                                [(ngModel)]="salesHeaderForm.total"
                                                
                                                readonly="true">
                                            </mat-form-field>
                                        </div>
                                    </div>
    
                                </div>
            
                            </div>

                        </div>

                        <div class="row divSection" *ngIf="salesHeaderForm.paymentList?.length > 0">
                            
                            <div class="col-md-12">
                                <div class="table-responsive">
                                    <table class="table table-hover">
                                        <thead>
                                            <th class="textAlingLeft padding-th">Forma de pago</th>
                                            <th class="textAlingRight padding-th">Pago</th>
                                            <th class="textAlingRight padding-th" *ngIf="interface.showFxRate">Pago EXT</th>
                                            <th class="textAlingRight padding-th" *ngIf="interface.showFxRate">Tipo de cambio</th>
                                            <th class="textAlingRight padding-th" *ngIf="interface.showReferencia">Referencia</th>
                                            <th class="textAlingLeft padding-th">Vendedor</th>
                                            <th class="textAlingCenter padding-th">Fecha</th>

                                        </thead>
                    
                                        <tbody>
                                            <tr *ngFor="let item of salesHeaderForm.paymentList; let i = index">
                                                
                                                <td style="text-align:left;">{{ item.formaPagoDesc }}</td>
                                                <td style="text-align: right;">{{ item.pago | currency }}</td>

                                                <td style="text-align: right;" *ngIf="interface.showFxRate">{{ item.pagoF | currency }}</td>
                                                <td style="text-align: right;" *ngIf="interface.showFxRate">{{ item.fxRate | currency }}</td>
                                                <td style="text-align: right;" *ngIf="interface.showReferencia">{{ item.referencia }}</td>

                                                <td style="text-align:left;">{{ item.sellerName }}</td>
                    
                                                <td class="textAlingCenter">
                    
                                                    <div class="row">
                                                        <div class="col-md-12">
                                                            <mat-icon style="margin-top: -5px;" matPrefix class="my-icon">calendar_today</mat-icon>
                                                            <label style="margin-left: 10px;">{{ item.createDate | date:'dd-MM-yyyy h:mm:ss a' }}</label>
                                                        </div>
                                                    </div>
                                                    
                                                </td>
                    
                                            </tr>
                                            
                                        </tbody>
                                        
                                    </table>
                                </div>
                    
                                <app-pagination *ngIf="salesHeaderForm.paymentList " [IPagination]="pagination"
                                    (OPagination)="changePagination($event)">
                                </app-pagination>
                            </div>

                        </div>
                
                </div>
            </div>

            <!-- <div class="row top20px">
                <div class="col-md-4">
                    <mat-form-field fxLayout.xs="column" class="with100">
                        <mat-label>Código de barras</mat-label>
                        <mat-icon matPrefix class="my-icon">qr_code</mat-icon>
                        <input matInput placeholder="Ingrese un Código de barras"
                        formControlName="barCode">
                        </mat-form-field>
                </div>

                <div class="col-md-4">
                    <mat-form-field class="with100">
                        <mat-label>Nombre</mat-label>
                        <input matInput placeholder="Ingrese un nombre"
                        formControlName="name">
                        </mat-form-field>
                </div>

                <div class="col-md-4">
                    <mat-form-field class="with100">
                        <mat-label>Descripción</mat-label>
                        <input matInput placeholder="Ingrese una descripción"
                        formControlName="description">
                        </mat-form-field>
                </div>

                
            </div> -->

            <!-- <div class="row top10px">
                <div class="col-md-12">
                    <div style="float: left;">
                        
                        <button mat-raised-button
                        color="primary"
                        type="submit"
                        class="marginRight10px"
                        (click)="fn_getProductsListWithPage()">
                        <mat-icon matPrefix class="my-icon">search</mat-icon>
                        Buscar</button>
                        
                        <button mat-raised-button
                        type="button"
                        (click)="parametersForm_Clear()">
                        <mat-icon matPrefix class="my-icon">clear</mat-icon>
                        limpiar</button>                
                        
                    </div>
                </div>
            </div> -->
    
        </div>
    
    </div>

</div>

<app-spinner [hidden]="!bShowSpinner"></app-spinner>